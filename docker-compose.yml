version: '3.8'

services:
  minecraft:
    image: itzg/minecraft-server:latest
    container_name: minecraft-server
    restart: unless-stopped
    ports:
      - "25565:25565"      # Java Edition TCP
      - "25565:25565/udp"  # Java Edition UDP
      - "19132:19132"      # Bedrock Edition TCP
      - "19132:19132/udp"  # Bedrock Edition UDP (REQUIRED for Bedrock)
    environment:
      EULA: "TRUE"
      VERSION: "1.21.3"
      TYPE: "PURPUR"
      JVM_FLAGS: "-Xms4G -Xmx4G -XX:+UseG1GC"
      VIEW_DISTANCE: "8"
      SIMULATION_DISTANCE: "4"
      MAX_PLAYERS: "20"
      # Bedrock/Geyser Settings
      ENABLE_GEYSER: "true"
      GEYSER_PORT: "19132"
      GEYSER_REMOTE_PORT: "25565"
      GEYSER_REMOTE_ADDRESS: "127.0.0.1"
      GEYSER_AUTH_TYPE: "online"
    volumes:
      - minecraft-data:/data
      - ./server/plugins:/plugins
    tty: true
    stdin_open: true
    cap_add:
      - NET_ADMIN  # Required for some network operations

volumes:
  minecraft-data:
